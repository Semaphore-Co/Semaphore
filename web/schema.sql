CREATE TABLE users (id INTEGER PRIMARY KEY AUTOINCREMENT, address TINYTEXT, name TINYTEXT DEFAULT NULL, auth DEFAULT NULL REFERENCES auth(id) ON DELETE SET NULL);
CREATE TABLE emails (email TINYTEXT, user INTEGER REFERENCES users(id) ON DELETE CASCADE);
CREATE TABLE email_confirmation (email TINYTEXT, user INTEGER REFERENCES users(id) ON DELETE CASCADE, code TINYTEXT);
CREATE TABLE phones (phone TINYTEXT, user INTEGER REFERENCES users(id) ON DELETE CASCADE);
CREATE TABLE phone_confirmation (phone TINYTEXT, user INTEGER REFERENCES users(id) ON DELETE CASCADE, code TINYTEXT);
CREATE TABLE confirmation_codes (code TINYTEXT);
CREATE TABLE auth (id INTEGER PRIMARY KEY AUTOINCREMENT, username TINYTEXT, salt TINYTEXT, hash TINYTEXT, user INTEGER REFERENCES users(id) ON DELETE CASCADE);
CREATE TABLE logins (id INTEGER PRIMARY KEY AUTOINCREMENT, code TINYTEXT, ip TINYTEXT, auth DEFAULT NULL REFERENCES auth(id) ON DELETE SET NULL, login_time DATETIME DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE login_codes (code TINYTEXT, user INTEGER REFERENCES users(id) ON DELETE CASCADE, login REFERENCES logins(id));
CREATE TABLE activity (login REFERENCES logins(id), url TINYTEXT, action_time DATETIME DEFAULT CURRENT_TIMESTAMP);